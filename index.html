        .status-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border-left: 4px solid #4caf50;
            max-width: 300px;
            z-index: 1000;
        }

        .demo-step {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 0.5rem;
            margin: 0.5rem 0;
            border-radius: 5px;
            font-size: 0.9rem;
        }<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AuraCare - Virtuaaliavustaja Ikäihmisille</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
        }

        .container {
            max-width: 900px;
            width: 90%;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 2rem;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 2rem;
        }

        .assistant-card {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 3px solid #4facfe;
            position: relative;
        }

        .avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 3rem;
            color: white;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            animation: breathe 3s ease-in-out infinite;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .conversation {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            font-size: 1.3rem;
            line-height: 1.6;
            max-height: 400px;
            overflow-y: auto;
        }

        .message {
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 10px;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .assistant-message {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            margin-right: 10%;
        }

        .user-message {
            background: #e8f5e8;
            border-left: 4px solid #4caf50;
            margin-left: 10%;
        }

        .system-message {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            font-style: italic;
            text-align: center;
        }

        .status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin: 1rem 0;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .status-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #4caf50;
            animation: pulse 2s infinite;
        }

        .listening-dot {
            background: #f44336;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        .auto-start-notice {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            margin: 1rem 0;
            font-size: 1.1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .timo-section {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            gap: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .timo-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid #4facfe;
            object-fit: cover;
            flex-shrink: 0;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .feature-card {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid #f0f0f0;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            border-color: #4facfe;
        }

        .demo-section {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 10px;
            margin: 2rem 0;
        }

        .demo-section h3 {
            color: #2c3e50;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .permission-notice {
            background: #fff3cd;
            padding: 1rem;
            border-radius: 10px;
            border-left: 4px solid #ffc107;
            margin: 1rem 0;
            text-align: center;
        }

        .process-tracker {
            position: fixed;
            left: 20px;
            top: 100px;
            background: rgba(255, 255, 255, 0.95);
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-left: 4px solid #4facfe;
            width: 280px;
            z-index: 999;
            backdrop-filter: blur(10px);
            display: block !important;
        }

        .process-step {
            display: flex;
            align-items: center;
            padding: 0.8rem;
            margin: 0.5rem 0;
            border-radius: 10px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .process-step.active {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border-color: #2196f3;
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
        }

        .process-step.completed {
            background: #e8f5e8;
            border-color: #4caf50;
        }

        .process-step.upcoming {
            background: #f5f5f5;
            color: #666;
        }

        .step-icon {
            font-size: 1.8rem;
            margin-right: 1rem;
            width: 40px;
            text-align: center;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: bold;
            font-size: 0.9rem;
            margin-bottom: 0.2rem;
        }

        .step-description {
            font-size: 0.75rem;
            opacity: 0.8;
        }

        .process-header {
            text-align: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #eee;
        }

        .process-header h3 {
            color: #2c3e50;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .process-header .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: #ff4757;
            font-weight: bold;
            font-size: 0.8rem;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: #ff4757;
            border-radius: 50%;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        @media (max-width: 1400px) {
            .process-tracker {
                width: 240px;
                left: 10px;
            }
        }

        @media (max-width: 1200px) {
            .process-tracker {
                display: none !important;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .timo-section {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌟 AuraCare</h1>
            <p>Läheisen ääni ääniohjattuna AI-avustajana - €125M markkinapotentiaali</p>
            <div style="background: rgba(255,255,255,0.2); padding: 1rem; border-radius: 10px; margin-top: 1rem;">
                <strong>💡 INNOVAATIO:</strong> Timo puhuu äitinsä Hilman kanssa 200km päästä käyttäen AuraCare-palvelua. 
                Läheisen ääni ja kasvot tekevät avustajasta tutun ja turvallisen!
            </div>
        </div>

        <div class="main-content">
            <div class="assistant-card">
                <div class="avatar">👨</div>
                <div class="status" id="status">
                    <div class="status-dot" id="statusDot"></div>
                    <span id="statusText">Timo käynnistyy automaattisesti...</span>
                </div>

                <div class="auto-start-notice">
                    ✨ <strong>LIVE-DEMO: Timo puhuu äitinsä Hilman kanssa etänä</strong><br>
                    📺 Näet miten Timo (poika) hoitaa äitinsä lääke- ja juomarutiinit 200km päästä<br>
                    🎤 Halutessasi voit kokeilla ääntä klikkaamalla alla
                </div>

                <div style="background: #e3f2fd; padding: 1rem; border-radius: 10px; margin: 1rem 0; border-left: 4px solid #2196f3;">
                    <strong>🚀 MITÄ NÄET DEMOSSA:</strong><br>
                    • Timo tervehtii äitiään Hilmaa ystävällisesti<br>
                    • Muistuttaa lääkkeistä ja odottaa 5s (ei 10min kuten kilpailijat)<br>
                    • Varmistaa turvallisesti että lääkkeet otettiin<br>
                    • Huolehtii äidin nesteytyksen seurannasta<br>
                    • Klikkaa Timon kuvaa alla → vaihda roolit keskenään!
                </div>

                <div class="permission-notice" id="permissionNotice" style="display: none;">
                    🎤 <strong>Salli mikrofonin käyttö:</strong><br>
                    • Klikkaa "Salli" tai "Allow" kun selain kysyy<br>
                    • Jos ei kysyy → klikkaa 🎤-ikonia osoiterivissä
                </div>

                <div class="permission-notice" id="errorNotice" style="display: none; background: #f8d7da; border-left-color: #dc3545;">
                    ❌ <strong>Ei hätää!</strong> Mikrofonilupa evätty, mutta demo toimii silti:<br>
                    📱 <strong>Automaattinen tekstidemo</strong> alkaa 3 sekunnin kuluttua...<br>
                    <small>Halutessasi voit aktivoida äänen myöhemmin alta</small>
                </div>

                <button id="manualStart" style="display: block; padding: 1rem 2rem; background: linear-gradient(135deg, #4caf50 0%, #45a049 100%); color: white; border: none; border-radius: 50px; font-size: 1.1rem; cursor: pointer; margin: 1rem auto; box-shadow: 0 5px 15px rgba(0,0,0,0.2);">
                    🎤 Kokeile äänimtoimintoja
                </button>

                <div class="conversation" id="conversation">
                    <div class="message system-message">
                        💫 AuraCare demo käynnistyy - Timo puhuu äitinsä kanssa automaattisesti...
                    </div>
                </div>
                
                <div id="statusIndicator" class="status-indicator" style="display: none;">
                    <div style="font-weight: bold; margin-bottom: 0.5rem;">📺 TIMO & HILMA LIVE</div>
                    <div id="currentStep">Odottaa...</div>
                </div>
            </div>

            <div class="timo-section">
                <div style="width: 80px; height: 80px; border-radius: 50%; border: 3px solid #4facfe; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; font-size: 2rem; color: white; cursor: pointer; transition: all 0.3s ease; flex-shrink: 0;" class="timo-avatar">
                    👨
                </div>
                <div>
                    <h4 style="color: #2c3e50; margin-bottom: 0.5rem;">👨‍👩‍👦 Timo - Nyt avustajana</h4>
                    <p style="color: #666; line-height: 1.6; margin: 0;">
                        "Asun 200km päässä äidistäni Hilmasta. AuraCare antaa minun puhua äitini kanssa oman ääninä ja kasvoillani. 
                        Äiti luottaa minuun enemmän kuin vieraan tekoälyn ääneen. 
                        <strong>Klikkaa kuvaani vaihtaaksesi roolit - innovaation ydin!</strong>"
                    </p>
                </div>
            </div>

            <div class="demo-section">
                <h3>🎯 Kuinka AuraCare toimii</h3>
                <div class="features">
                    <div class="feature-card">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">🚀</div>
                        <h4>Automaattinen käynnistys</h4>
                        <p>Ei painikkeita - Aura kysyy automaattisesti "Haluatko jutella?"</p>
                    </div>
                    <div class="feature-card">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">🧠</div>
                        <h4>AI-älykkäisyys</h4>
                        <p>Vastaa kaikkiin Hilman kysymyksiin ja hakee tietoa internetistä</p>
                    </div>
                    <div class="feature-card">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">💊</div>
                        <h4>Lääkerutiinit</h4>
                        <p>Muistuttaa → Odottaa (5s) → Varmistaa ottamisen → Turvallisesti hoidettu</p>
                    </div>
                    <div class="feature-card">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">💧</div>
                        <h4>Juomamuistutukset</h4>
                        <p>Säännöllinen nesteiden nauttiminen - erityisen tärkeää lääkkeiden kanssa</p>
                    </div>
                    <div class="feature-card">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">👨‍👩‍👦</div>
                        <h4>Läheisen ääni</h4>
                        <p>Timon ääni voi puhua Hilman puolesta - klikkaa Timon kuvaa kokeillaksesi!</p>
                    </div>
                </div>
            </div>

            <div style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); color: white; padding: 2rem; border-radius: 15px; margin: 2rem 0; text-align: center;">
                <h3 style="margin-bottom: 1rem; font-size: 1.8rem;">🎯 SIJOITUSMAHDOLLISUUS</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <div>
                        <h4 style="font-size: 2rem; margin-bottom: 0.5rem;">1.2M</h4>
                        <p>Ikäihmistä Suomessa</p>
                    </div>
                    <div>
                        <h4 style="font-size: 2rem; margin-bottom: 0.5rem;">30%</h4>
                        <p>Asuu yksin (360k henkilöä)</p>
                    </div>
                    <div>
                        <h4 style="font-size: 2rem; margin-bottom: 0.5rem;">€29/kk</h4>
                        <p>Realistinen hinnoittelu</p>
                    </div>
                    <div>
                        <h4 style="font-size: 2rem; margin-bottom: 0.5rem;">€125M</h4>
                        <p>Kokonaismarkkina (TAM)</p>
                    </div>
                </div>
                <div style="margin-top: 1rem; padding: 1rem; background: rgba(255,255,255,0.2); border-radius: 10px;">
                    <strong>🚀 SKAALAUTUVUUS:</strong> Pohjoismaat (5M ikäihmistä) → €1.7B markkina
                </div>
            </div>
        </div>
    </div>

    <script>
        class AuraCareAI {
            constructor() {
                this.recognition = null;
                this.synthesis = window.speechSynthesis;
                this.conversationEl = document.getElementById('conversation');
                this.statusEl = document.getElementById('status');
                this.statusDot = document.getElementById('statusDot');
                this.statusText = document.getElementById('statusText');
                this.permissionNotice = document.getElementById('permissionNotice');
                this.errorNotice = document.getElementById('errorNotice');
                this.manualStart = document.getElementById('manualStart');
                this.statusIndicator = document.getElementById('statusIndicator');
                this.currentStep = document.getElementById('currentStep');
                
                this.isListening = false;
                this.conversationState = 'initial';
                this.waitingForResponse = false;
                this.voiceEnabled = false;
                this.timoSpeaking = false;
                this.currentProcessStep = 0;
                
                this.initVoice();
                this.setupEventListeners();
                this.startDemo();
            }

            initProcessTracker() {
                // Luo prosessiseuranta dynaamisesti
                const processTracker = document.createElement('div');
                processTracker.id = 'processTracker';
                processTracker.className = 'process-tracker';
                processTracker.innerHTML = `
                    <div class="process-header">
                        <h3>🔄 Hoivaprosessi</h3>
                        <div class="live-indicator">
                            <div class="live-dot"></div>
                            LIVE DEMO
                        </div>
                    </div>
                    
                    <div class="process-step upcoming" id="step-1">
                        <div class="step-icon">📞</div>
                        <div class="step-content">
                            <div class="step-title">Yhteydenotto</div>
                            <div class="step-description">Timo soittaa äidilleen</div>
                        </div>
                    </div>

                    <div class="process-step upcoming" id="step-2">
                        <div class="step-icon">💊</div>
                        <div class="step-content">
                            <div class="step-title">Lääkemuistutus</div>
                            <div class="step-description">Muistuttaa aamulääkkeistä</div>
                        </div>
                    </div>

                    <div class="process-step upcoming" id="step-3">
                        <div class="step-icon">⏱️</div>
                        <div class="step-content">
                            <div class="step-title">Odotus</div>
                            <div class="step-description">5s aika lääkkeiden otolle</div>
                        </div>
                    </div>

                    <div class="process-step upcoming" id="step-4">
                        <div class="step-icon">✅</div>
                        <div class="step-content">
                            <div class="step-title">Varmistus</div>
                            <div class="step-description">Tarkistaa että otettiin</div>
                        </div>
                    </div>

                    <div class="process-step upcoming" id="step-5">
                        <div class="step-icon">💧</div>
                        <div class="step-content">
                            <div class="step-title">Nesteytys</div>
                            <div class="step-description">Muistuttaa veden juonnista</div>
                        </div>
                    </div>

                    <div class="process-step upcoming" id="step-6">
                        <div class="step-icon">🌸</div>
                        <div class="step-content">
                            <div class="step-title">Seurustelu</div>
                            <div class="step-description">Mukava keskustelu</div>
                        </div>
                    </div>

                    <div class="process-step upcoming" id="step-7">
                        <div class="step-icon">❤️</div>
                        <div class="step-content">
                            <div class="step-title">Läheisyys</div>
                            <div class="step-description">Pojan rakkaus etänä</div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(processTracker);
                this.processTracker = processTracker;
            }

            updateProcessStep(stepNumber) {
                // Piilota kaikki aktiiviset
                document.querySelectorAll('.process-step').forEach(step => {
                    step.classList.remove('active');
                    step.classList.add('upcoming');
                });

                // Merkitse aiemmat valmistuneiksi
                for (let i = 1; i < stepNumber; i++) {
                    const step = document.getElementById(`step-${i}`);
                    if (step) {
                        step.classList.remove('upcoming', 'active');
                        step.classList.add('completed');
                    }
                }

                // Merkitse nykyinen aktiiviseksi
                const currentStep = document.getElementById(`step-${stepNumber}`);
                if (currentStep) {
                    currentStep.classList.remove('upcoming', 'completed');
                    currentStep.classList.add('active');
                }

                this.currentProcessStep = stepNumber;
            }

            setupEventListeners() {
                this.manualStart.addEventListener('click', () => {
                    this.requestMicrophonePermission();
                });
                
                // Klikkaus Timon avatariin aktivoi "läheinen puhuu" -tilan
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('timo-avatar')) {
                        this.toggleTimoSpeaking();
                    }
                });
            }

            toggleTimoSpeaking() {
                this.timoSpeaking = !this.timoSpeaking;
                const timoAvatar = document.querySelector('.timo-avatar');
                
                if (this.timoSpeaking) {
                    timoAvatar.style.border = '4px solid #4caf50';
                    timoAvatar.style.animation = 'pulse 1s infinite';
                    timoAvatar.style.background = 'linear-gradient(135deg, #4caf50 0%, #45a049 100%)';
                    timoAvatar.innerHTML = '👵';
                    this.addMessage('🔄 ROOLIT VAIHDETTU: Nyt Hilma puhuu Timon sijasta! (klikkaa vaihtaaksesi takaisin)', 'system');
                    this.updateDemoStep('👵 Hilma puhuu nyt');
                } else {
                    timoAvatar.style.border = '3px solid #4facfe';
                    timoAvatar.style.animation = '';
                    timoAvatar.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                    timoAvatar.innerHTML = '👨';
                    this.addMessage('🔄 TAKAISIN NORMAALIIN: Timo puhuu taas äitinsä kanssa 200km päästä', 'system');
                    this.updateDemoStep('👨 Timo avustajana');
                }
            }

            async startDemo() {
                this.updateStatus('AuraCare demo käynnistyy...', 'loading');
                this.addMessage('💫 Tervetuloa AuraCare-demoon!', 'system');
                
                // Luo ja näytä prosessiseuranta
                this.initProcessTracker();
                
                await this.delay(2000);
                
                // Aloita tekstidemo automaattisesti 5 sekunnin kuluttua
                setTimeout(() => {
                    if (!this.voiceEnabled) {
                        this.addMessage('📱 Aloitetaan Timo & Hilma demo...', 'system');
                        this.startTextDemo();
                    }
                }, 5000);
                
                this.updateStatus('Klikkaa alla kokeillaksesi ääntä tai odota automaattista demoa', 'loading');
            }

            async requestMicrophonePermission() {
                try {
                    this.permissionNotice.style.display = 'block';
                    this.errorNotice.style.display = 'none';
                    this.manualStart.style.display = 'none';
                    
                    // Pyydä mikrofonin käyttölupa
                    await navigator.mediaDevices.getUserMedia({ audio: true });
                    
                    // Jos onnistui, käynnistä puheentunnistus
                    this.voiceEnabled = true;
                    this.permissionNotice.style.display = 'none';
                    await this.startVoiceDemo();
                    
                } catch (error) {
                    console.log('Mikrofoni-virhe:', error);
                    this.showPermissionError();
                }
            }

            initVoice() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    this.recognition = new SpeechRecognition();
                    this.recognition.lang = 'fi-FI';
                    this.recognition.continuous = true;
                    this.recognition.interimResults = false;
                    
                    this.recognition.onresult = (event) => {
                        const transcript = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();
                        if (transcript && !this.waitingForResponse) {
                            this.handleVoiceInput(transcript);
                        }
                    };
                    
                    this.recognition.onerror = (event) => {
                        console.log('Puheentunnistus virhe:', event.error);
                        if (event.error === 'not-allowed') {
                            this.showPermissionError();
                        } else if (event.error === 'no-speech') {
                            // Ei ongelmaa, jatka kuuntelua
                        } else {
                            this.updateStatus('Puheentunnistusvirhe', 'error');
                        }
                    };
                    
                    this.recognition.onend = () => {
                        if (this.isListening) {
                            setTimeout(() => {
                                try {
                                    this.recognition.start();
                                } catch (e) {
                                    console.log('Uudelleenkäynnistys epäonnistui');
                                }
                            }, 1000);
                        }
                    };
                }
            }

            async startVoiceDemo() {
                this.updateStatus('Aura käynnistyy...', 'loading');
                
                try {
                    this.recognition.start();
                    this.isListening = true;
                    
                    await this.delay(1000);
                    this.updateStatus('Aura kuuntelee sinua', 'listening');
                    
                    // Aloita automaattisesti
                    await this.delay(1000);
                    const greeting = 'Hei! Minä olen Aura. Haluatko jutella hetken kanssani?';
                    this.addMessage(greeting, 'assistant');
                    this.speak(greeting);
                    this.conversationState = 'greeting';
                    
                } catch (error) {
                    console.log('Puheentunnistus-virhe:', error);
                    this.showPermissionError();
                }
            }

            showPermissionError() {
                this.permissionNotice.style.display = 'none';
                this.errorNotice.style.display = 'block';
                this.updateStatus('Tekstidemo alkaa...', 'loading');
                
                // Aloita tekstidemo automaattisesti 3 sekunnin kuluttua
                setTimeout(() => {
                    this.errorNotice.style.display = 'none';
                    this.startTextDemo();
                }, 3000);
            }

            updateDemoStep(step) {
                this.currentStep.innerHTML = step;
                this.statusIndicator.style.display = 'block';
            }

            async startTextDemo() {
                this.updateStatus('Timo soittaa äidilleen', 'loading');
                this.updateProcessStep(1);
                
                await this.delay(1000);
                this.addMessage('Hei äiti! Minä olen Timo. Miten jaksat tänään? Onko aika ottaa aamulääkkeet?', 'assistant');
                this.updateProcessStep(2);
                
                await this.delay(3000);
                this.addMessage('Hei poikaseni! Kyllä, pitäisi ottaa', 'user');
                
                await this.delay(2000);
                this.addMessage('Hyvä äiti! Käy ottamassa lääkkeet nyt rauhassa. Odotan täällä 5 sekuntia.', 'assistant');
                this.updateProcessStep(3);
                
                await this.delay(5000);
                this.addMessage('Otitko lääkkeet, äiti?', 'assistant');
                this.updateProcessStep(4);
                
                await this.delay(2000);
                this.addMessage('Kyllä poikaseni, otin kaikki', 'user');
                
                await this.delay(2000);
                this.addMessage('Erinomaista äiti! Olet hoitanut asian hyvin. Nyt muistutus juomisesta - oletko juonut aamulla vettä?', 'assistant');
                this.updateProcessStep(5);
                
                await this.delay(3000);
                this.addMessage('En vielä paljoa poikaseni...', 'user');
                
                await this.delay(2000);
                this.addMessage('Äiti, käy hakemassa lasi vettä nyt heti. Juominen on erityisen tärkeää lääkkeiden kanssa. Odotan että juot sen.', 'assistant');
                
                await this.delay(4000);
                this.addMessage('Join lasillisen, Timo kulta', 'user');
                
                await this.delay(2000);
                this.addMessage('Kiitos äiti! Nyt sinulla on hyvä alku päivälle. Haluaisitko jutella jostain kivasta? Voisimme puhua kukista tai säästä?', 'assistant');
                this.updateProcessStep(6);
                
                await this.delay(3000);
                this.addMessage('Kyllä poikaseni, kukkien hoidosta', 'user');
                
                await this.delay(2000);
                this.addMessage('Mahtavaa äiti! Onko sinulla kukkia kotona? Kesäkukkien kastelu on tärkeää näin lämpimässä säässä - aivan kuten sinunkin juominen!', 'assistant');
                
                await this.delay(3000);
                this.addMessage('On Timo kulta, pelargoniat ikkunalla', 'user');
                
                await this.delay(2000);
                this.addMessage('Voi kuinka ihanaa äiti! Pelargoniat ovat todella kauniita. Muista kastella niitä säännöllisesti. Ja muista juoda itse myös säännöllisesti päivän aikana!', 'assistant');
                
                await this.delay(4000);
                this.addMessage('Kiitos Timo kulta, olet niin kiltti poika', 'user');
                
                await this.delay(2000);
                this.addMessage('Rakas äiti, olen aina täällä kun tarvitset. Soitan uudelleen jos huomaan jotain. Pidä huolta itsestäsi!', 'assistant');
                this.updateProcessStep(7);
                
                await this.delay(3000);
                this.addMessage('✨ Demo päättynyt! Näit miten Timo hoitaa äitinsä hyvinvointia 200km päästä. Klikkaa Timon kuvaa vaihtaaksesi roolit!', 'system');
                this.updateStatus('Demo valmis - kokeile roolien vaihtoa!', 'listening');
                
                // Merkitse kaikki valmistuneiksi
                for (let i = 1; i <= 7; i++) {
                    const step = document.getElementById(`step-${i}`);
                    if (step) {
                        step.classList.remove('active', 'upcoming');
                        step.classList.add('completed');
                    }
                }
            }

            handleVoiceInput(transcript) {
                if (this.waitingForResponse) return;
                
                this.addMessage(transcript, 'user');
                this.waitingForResponse = true;
                
                let response = '';
                
                switch (this.conversationState) {
                    case 'greeting':
                        if (transcript.includes('kyllä') || transcript.includes('joo') || transcript.includes('halua')) {
                            response = 'Ihanaa! Sopiiko sinulle, jos juttelemme kukista?';
                            this.conversationState = 'topic_choice';
                        } else if (transcript.includes('ei') || transcript.includes('en')) {
                            response = 'Ei se mitään. Olen täällä aina kun tarvitset. Pidä huolta itsestäsi!';
                            this.conversationState = 'ending';
                        } else {
                            response = 'En aivan ymmärtänyt. Haluatko jutella kanssani? Voit sanoa kyllä tai ei.';
                        }
                        break;
                        
                    case 'topic_choice':
                        if (transcript.includes('kyllä') || transcript.includes('joo') || transcript.includes('sopi')) {
                            response = 'Mahtavaa! Onko sinulla kukkia kotona? Minä rakastan kesäkukkia - ne tuovat niin paljon iloa!';
                            this.conversationState = 'chat';
                        } else {
                            response = 'Selvä! Mistä haluaisit jutella? Voisimme puhua säästä, perheestä tai mistä tahansa?';
                            this.conversationState = 'chat';
                        }
                        break;
                        
                    case 'chat':
                        response = this.generateSmartResponse(transcript);
                        break;
                        
                    default:
                        if (transcript.includes('hei') || transcript.includes('moi') || transcript.includes('terve')) {
                            response = 'Hei! Minä olen Aura. Haluatko jutella hetken kanssani?';
                            this.conversationState = 'greeting';
                        } else {
                            response = 'Kuulen sinua! Sano "hei" niin aloitetaan keskustelu.';
                        }
                }
                
                setTimeout(() => {
                    this.addMessage(response, 'assistant');
                    this.speak(response);
                    this.waitingForResponse = false;
                }, 1000);
            }

            generateSmartResponse(input) {
                // Yksinkertainen AI-simulaatio - oikeassa tuotteessa käytettäisiin GPT API:a
                const responses = {
                    kukat: [
                        'Kukkien hoito on tärkeää! Muista kastella niitä säännöllisesti.',
                        'Pelargoniat ovat todella kauniita. Oletko muistanut kastella niitä?',
                        'Kesäkukkien kastelua tarvitaan lämpimässä säässä. Ja muista juoda itse myös vettä!'
                    ],
                    sää: [
                        'Tänään on kaunis päivä! Muista juoda riittävästi vettä lämpimässä säässä.',
                        'Säätiedotuksen mukaan tulee olemaan aurinkoista. Hyvä päivä ulkoiluun!'
                    ],
                    lääke: [
                        'Lääkkeiden otto on tärkeää. Oletko muistanut ottaa tämän päivän lääkkeet?',
                        'Jos unohdat lääkkeet, älä ota kaksinkertaista annosta. Ota vain seuraava normaali annos.'
                    ],
                    perhe: [
                        'Perhe on tärkeä! Onko sinulla yhteyttä läheisiin säännöllisesti?',
                        'Mukava kuulla perheestä. Soittavatko lapset ja lastenlapset usein?'
                    ],
                    piha: [
                        'Pihassa on varmasti kaunista nyt kesällä! Viihdytkö ulkona?',
                        'Piha-askareet voivat olla mukavaa puuhaa. Muista kuitenkin levätä välillä.'
                    ],
                    kiitos_ei: [
                        'Selvä! Jos tulee mieleen jotain muuta, olen täällä. Pidä huolta itsestäsi!',
                        'Hyvä on. Soitan Timolle jos tarvitset apua. Muista juoda vettä päivän aikana!',
                        'Ymmärrän. Olen täällä aina kun tarvitset. Hyvää päivänjatkoa, Hilma!'
                    ],
                    default: [
                        'Se kuulostaa mielenkiintoiselta! Kerro lisää.',
                        'Ymmärrän. Onko jotain muuta mielessäsi?',
                        'Kiitos kun jaat ajatuksiasi kanssani. Mitä muuta voisi jutella?'
                    ]
                };
                
                let category = 'default';
                
                // Tunnista "ei kiitos" tyyppisiä vastauksia
                if ((input.includes('kiitos') && input.includes('ei')) || 
                    input.includes('ei kiitos') || 
                    (input.includes('ei') && input.length < 10)) {
                    category = 'kiitos_ei';
                }
                else if (input.includes('kukka') || input.includes('kasvi') || input.includes('puutarha') || input.includes('ruusu') || input.includes('pihassa')) category = 'kukat';
                else if (input.includes('sää') || input.includes('lämpö') || input.includes('aurinko')) category = 'sää';
                else if (input.includes('lääke') || input.includes('tabletti') || input.includes('resepti')) category = 'lääke';
                else if (input.includes('perhe') || input.includes('lapsi') || input.includes('poika') || input.includes('tyttö')) category = 'perhe';
                else if (input.includes('piha') || input.includes('puutarha') || input.includes('ulko')) category = 'piha';
                
                const categoryResponses = responses[category];
                return categoryResponses[Math.floor(Math.random() * categoryResponses.length)];
            }

            speak(text) {
                if (this.synthesis) {
                    this.synthesis.cancel();
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'fi-FI';
                    utterance.rate = 0.8;
                    utterance.pitch = 1.1;
                    utterance.volume = 0.9;
                    this.synthesis.speak(utterance);
                }
            }

            addMessage(text, type) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${type}-message`;
                
                let content = '';
                if (type === 'assistant') {
                    content = `<strong>Aura:</strong> ${text}`;
                } else if (type === 'user') {
                    content = `<strong>Hilma:</strong> ${text}`;
                } else {
                    content = text;
                }
                
                messageDiv.innerHTML = content;
                this.conversationEl.appendChild(messageDiv);
                this.conversationEl.scrollTop = this.conversationEl.scrollHeight;
            }

            updateStatus(text, type) {
                this.statusText.textContent = text;
                this.statusDot.className = 'status-dot';
                
                if (type === 'listening') {
                    this.statusDot.classList.add('listening-dot');
                } else if (type === 'error') {
                    this.statusDot.style.background = '#f44336';
                } else if (type === 'loading') {
                    this.statusDot.style.background = '#ff9800';
                }
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // Käynnistä AuraCare automaattisesti
        document.addEventListener('DOMContentLoaded', () => {
            new AuraCareAI();
        });
    </script>
</body>
</html>